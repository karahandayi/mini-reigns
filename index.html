<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Mini Reigns + BaÅŸlangÄ±Ã§ + Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body,html{margin:0;padding:0;width:100%;height:100%;font-family:Arial;background:#111; color:white;}
#start-screen,#game{width:100vw;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;transition:opacity 0.5s;}
#start-screen{z-index:10;}
#start-screen button{padding:20px 40px;font-size:24px;cursor:pointer;border:none;border-radius:10px;background:#444;color:white;}
#game{display:none;flex-direction:column;align-items:center;justify-content:flex-start;overflow:hidden;}
#stats{width:90%;display:flex;justify-content:space-between;margin-top:10px;}
.stat{width:23%;}
.bar{height:10px;background:#333;border-radius:5px;overflow:hidden;}
.fill{height:100%;background:lime;width:50%;transition:width 0.3s;}
#card-container{flex:1;display:flex;align-items:center;justify-content:center;width:100%;}
#card{width:300px;height:180px;background:#2c2c2c;border-radius:12px;padding:20px;text-align:center;cursor:grab;user-select:none;display:flex;flex-direction:column;justify-content:center;align-items:center;transition:transform 0.2s;}
#card img{max-width:80px;margin-bottom:10px;border-radius:5px;}
#hint{margin-bottom:20px;opacity:0.6;}
#admin-toggle{position:fixed;bottom:10px;left:10px;padding:5px 10px;background:#444;cursor:pointer;border-radius:5px;z-index:1000;font-size:14px;}
#admin{position:fixed;bottom:50px;left:10px;background:#333;padding:10px;border-radius:8px;width:300px;display:none;color:white;overflow-y:auto;max-height:80vh;z-index:1000;}
#admin input,#admin textarea,#admin button,#admin label{width:100%;margin:3px 0;padding:5px;}
#card-list li{cursor:pointer;margin-bottom:3px;}
#admin h3,#admin h4{margin:5px 0;text-align:center;}
#music-controls{margin:5px 0;display:flex;justify-content:space-between;}
</style>
</head>
<body>

<!-- BaÅŸlangÄ±Ã§ ekranÄ± -->
<div id="start-screen">
  <h1>Mini Reigns</h1>
  <button id="start-btn">BaÅŸla</button>
</div>

<!-- Oyun ekranÄ± -->
<div id="game">
  <div id="stats">
    <div class="stat">ğŸ‘‘ <span class="stat-title">Halk</span><div class="bar"><div id="halk" class="fill"></div></div></div>
    <div class="stat">â›ª <span class="stat-title">Kilise</span><div class="bar"><div id="kilise" class="fill"></div></div></div>
    <div class="stat">ğŸ’° <span class="stat-title">Hazine</span><div class="bar"><div id="hazine" class="fill"></div></div></div>
    <div class="stat">âš”ï¸ <span class="stat-title">Ordu</span><div class="bar"><div id="ordu" class="fill"></div></div></div>
  </div>
  <div id="card-container">
    <div id="card"><img id="card-img" src="" alt=""><div id="card-text"></div></div>
  </div>
  <div id="hint">â† HAYIR | EVET â†’</div>
</div>

<!-- Admin paneli -->
<div id="admin-toggle">Admin Paneli</div>
<div id="admin">
  <h3>Admin Paneli</h3>
  
  <h4>BaÅŸlangÄ±Ã§ EkranÄ± Arkaplan</h4>
  <input id="admin-start-bg" placeholder="https://example.com/start-bg.jpg">

  <h4>Oyun ArkaplanÄ±</h4>
  <input id="admin-bg" placeholder="https://example.com/game-bg.jpg">

  <h4>MÃ¼zik (YouTube)</h4>
  <input id="admin-music" placeholder="YouTube linki">
  <div id="music-controls">
    <button id="play-music">â–¶ï¸ AÃ§</button>
    <button id="pause-music">â¸ Kapat</button>
  </div>

  <h4>Stat BaÅŸlangÄ±Ã§</h4>
  <label>Halk:</label><input id="admin-halk" type="number" value="50">
  <label>Kilise:</label><input id="admin-kilise" type="number" value="50">
  <label>Hazine:</label><input id="admin-hazine" type="number" value="50">
  <label>Ordu:</label><input id="admin-ordu" type="number" value="50">

  <h4>Stat BaÅŸlÄ±klarÄ±</h4>
  <label>Stat 1:</label><input id="admin-title-halk" type="text" value="Halk">
  <label>Stat 2:</label><input id="admin-title-kilise" type="text" value="Kilise">
  <label>Stat 3:</label><input id="admin-title-hazine" type="text" value="Hazine">
  <label>Stat 4:</label><input id="admin-title-ordu" type="text" value="Ordu">

  <hr>
  <h4>Kart Ekle/DÃ¼zenle</h4>
  <textarea id="admin-text" placeholder="Kart metni"></textarea>
  <input id="admin-img" placeholder="Kart gÃ¶rsel URL">
  <input id="admin-yes" placeholder='{"halk":10,"hazine":-5}'>
  <input id="admin-no" placeholder='{"halk":-5}'>
  <button id="add-card">Kart Ekle</button>

  <hr>
  <h4>Mevcut Kartlar</h4>
  <ul id="card-list"></ul>
</div>

<!-- MÃ¼zik iframe -->
<div id="music-container" style="display:none;"></div>

<script>
// BaÅŸlangÄ±Ã§ ekranÄ±
const startScreen = document.getElementById("start-screen");
const startBtn = document.getElementById("start-btn");
const game = document.getElementById("game");

// Admin toggle
const adminToggle = document.getElementById("admin-toggle");
const admin = document.getElementById("admin");

// Stats ve kartlar
let stats = { halk:50, kilise:50, hazine:50, ordu:50 };
let cards = [
  { text:"KÃ¶ylÃ¼ler vergilerin dÃ¼ÅŸÃ¼rÃ¼lmesini istiyor.", img:"https://via.placeholder.com/80", yes:{halk:10,hazine:-10}, no:{halk:-10} },
  { text:"Ordu yeni silahlar istiyor.", img:"https://via.placeholder.com/80", yes:{ordu:10,hazine:-15}, no:{ordu:-10} }
];
const cardEl = document.getElementById("card");
const cardText = document.getElementById("card-text");
const cardImg = document.getElementById("card-img");
const gameDiv = document.getElementById("game");

// MÃ¼zik
let musicFrame = null;
let musicUrl = "";

// BaÅŸlat butonu
startBtn.onclick = ()=>{
  startScreen.style.display="none";
  game.style.display="flex";
};

// Admin panel toggle
adminToggle.onclick = ()=>{
  admin.style.display = admin.style.display=="block"?"none":"block";
};

// Update stats
function updateStats(){
  for(let key in stats){
    stats[key]=Math.max(0,Math.min(100,stats[key]));
    document.getElementById(key).style.width = stats[key]+"%";
  }
}

// Check death
function checkDeath(){
  for(let key in stats){
    if(stats[key]<=0 || stats[key]>=100){
      alert("Ã–ldÃ¼n! Sebep: "+key.toUpperCase());
      location.reload();
    }
  }
}

// Kartlar
let currentCard = null;
function nextCard(){
  if(cards.length==0){ cardText.innerText="Kart yok"; cardImg.src=""; return; }
  currentCard = cards[Math.floor(Math.random()*cards.length)];
  cardText.innerText = currentCard.text;
  cardImg.src = currentCard.img || "";
  cardEl.style.transform="translateX(0px)";
}

// Drag mekanizmasÄ±
let startX=0, dragging=false;
cardEl.addEventListener("mousedown", e=>{ dragging=true; startX=e.clientX; });
document.addEventListener("mousemove", e=>{ if(!dragging)return; let dx=e.clientX-startX; cardEl.style.transform=`translateX(${dx}px) rotate(${dx/10}deg)`; });
document.addEventListener("mouseup", e=>{ if(!dragging)return; dragging=false; handleDecision(e.clientX-startX); });
cardEl.addEventListener("touchstart", e=>{ startX=e.touches[0].clientX; });
cardEl.addEventListener("touchmove", e=>{ let dx=e.touches[0].clientX-startX; cardEl.style.transform=`translateX(${dx}px) rotate(${dx/10}deg)`; });
cardEl.addEventListener("touchend", e=>{ let dx=parseInt(cardEl.style.transform.match(/-?\d+/))||0; handleDecision(dx); });

function handleDecision(dx){
  if(dx>100) applyResult("yes");
  else if(dx<-100) applyResult("no");
  else cardEl.style.transform="translateX(0px)";
}

function applyResult(choice){
  const effects = currentCard[choice];
  for(let key in effects) stats[key]+=effects[key];
  updateStats(); checkDeath(); nextCard();
}

// BaÅŸlat
updateStats();
nextCard();

// Admin kart ekleme/dÃ¼zenleme
function refreshCardList(){
  const list = document.getElementById("card-list");
  list.innerHTML="";
  cards.forEach((c,i)=>{
    const li = document.createElement("li");
    li.innerText = c.text;
    li.onclick = ()=>{
      document.getElementById("admin-text").value=c.text;
      document.getElementById("admin-img").value=c.img||"";
      document.getElementById("admin-yes").value=JSON.stringify(c.yes);
      document.getElementById("admin-no").value=JSON.stringify(c.no);
    };
    list.appendChild(li);
  });
}
refreshCardList();

document.getElementById("add-card").onclick = ()=>{
  const text = document.getElementById("admin-text").value;
  const img = document.getElementById("admin-img").value;
  let yes,no;
  try{
    yes = JSON.parse(document.getElementById("admin-yes").value);
    no = JSON.parse(document.getElementById("admin-no").value);
  }catch(e){ alert("JSON hatalÄ±!"); return; }
  cards.push({text,img,yes,no});
  refreshCardList();
  nextCard();
  alert("Kart eklendi!");
};

// Stat deÄŸerleri
["halk","kilise","hazine","ordu"].forEach(key=>{
  document.getElementById("admin-"+key).onchange = e=>{
    stats[key]=parseInt(e.target.value)||50;
    updateStats();
  };
});

// Stat baÅŸlÄ±klarÄ±
document.getElementById("admin-title-halk").oninput = e => { document.querySelector('#stats .stat:nth-child(1) .stat-title').innerText = e.target.value; };
document.getElementById("admin-title-kilise").oninput = e => { document.querySelector('#stats .stat:nth-child(2) .stat-title').innerText = e.target.value; };
document.getElementById("admin-title-hazine").oninput = e => { document.querySelector('#stats .stat:nth-child(3) .stat-title').innerText = e.target.value; };
document.getElementById("admin-title-ordu").oninput = e => { document.querySelector('#stats .stat:nth-child(4) .stat-title').innerText = e.target.value; };

// BaÅŸlangÄ±Ã§ ekranÄ± arkaplan
document.getElementById("admin-start-bg").oninput = e=>{
  startScreen.style.background=`url(${e.target.value}) center/cover no-repeat`;
};

// Oyun arkaplan
document.getElementById("admin-bg").oninput = e=>{
  gameDiv.style.background=`url(${e.target.value}) center/cover no-repeat`;
};

// MÃ¼zik kontrol
const musicInput = document.getElementById("admin-music");
const playBtn = document.getElementById("play-music");
const pauseBtn = document.getElementById("pause-music");
playBtn.onclick = ()=>{
  if(musicFrame) musicFrame.remove();
  const link = musicInput.value;
  if(link){
    let videoId="";
    try{ videoId=link.split("v=")[1].split("&")[0]; }catch(e){ videoId=""; }
    if(videoId){
      musicFrame = document.createElement("iframe");
      musicFrame.width=0; musicFrame.height=0; musicFrame.src=`https://www.youtube.com/embed/${videoId}?autoplay=1&loop=1&playlist=${videoId}`;
      musicFrame.allow="autoplay";
      musicFrame.style.display="none";
      document.body.appendChild(musicFrame);
    }
  }
};
pauseBtn.onclick = ()=>{ if(musicFrame) musicFrame.remove(); musicFrame=null; };

</script>
</body>
</html>
